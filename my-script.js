const _0x1ca384=_0x4361;(function(_0x555d3e,_0x95cedf){const _0x5a550e=_0x4361,_0x559e2a=_0x555d3e();while(!![]){try{const _0x4a8507=parseInt(_0x5a550e(0x1e7))/0x1+-parseInt(_0x5a550e(0x1ee))/0x2*(-parseInt(_0x5a550e(0x1d3))/0x3)+-parseInt(_0x5a550e(0x1fc))/0x4+-parseInt(_0x5a550e(0x1f2))/0x5*(-parseInt(_0x5a550e(0x220))/0x6)+parseInt(_0x5a550e(0x206))/0x7+-parseInt(_0x5a550e(0x1fd))/0x8+-parseInt(_0x5a550e(0x1d8))/0x9;if(_0x4a8507===_0x95cedf)break;else _0x559e2a['push'](_0x559e2a['shift']());}catch(_0x1a7265){_0x559e2a['push'](_0x559e2a['shift']());}}}(_0x4353,0xc7764));import{initializeApp}from'https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js';import{getDatabase,ref,push,onChildAdded,onChildRemoved,remove,onValue,set,off}from'https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js';import{getStorage,ref as _0x3687f9,uploadBytes,getDownloadURL}from'https://www.gstatic.com/firebasejs/9.22.2/firebase-storage.js';const firebaseConfig={'apiKey':_0x1ca384(0x217),'authDomain':_0x1ca384(0x1cc),'databaseURL':_0x1ca384(0x1ca),'projectId':'imagefeed-45d0e','storageBucket':_0x1ca384(0x20e),'messagingSenderId':_0x1ca384(0x1fb),'appId':_0x1ca384(0x1ff)},app=initializeApp(firebaseConfig),db=getDatabase(app),storage=getStorage(app),roomsRef=ref(db,'rooms'),activeUsersRef=ref(db,_0x1ca384(0x1ec)),kickedUsersRef=ref(db,_0x1ca384(0x1fe)),typingStatusRef=ref(db,_0x1ca384(0x1ea));let username='',userEmail='',roomCode='',currentUserId=null,currentRoomRef=null,userKickListener=null,typingTimeout=null,isTyping=![],showRoomCode=![];document[_0x1ca384(0x1f3)](_0x1ca384(0x203),()=>{const _0x5daf14=_0x1ca384,_0x4b06a8=document[_0x5daf14(0x1c4)](_0x5daf14(0x1e4)),_0x55bf31=document[_0x5daf14(0x1c4)](_0x5daf14(0x21f));_0x4b06a8[_0x5daf14(0x1f3)](_0x5daf14(0x205),()=>{const _0x3d335d=_0x5daf14;showRoomCode=!showRoomCode,_0x4b06a8[_0x3d335d(0x1d4)]=showRoomCode?'👁':'👁',_0x55bf31[_0x3d335d(0x1d4)]=showRoomCode?roomCode:_0x3d335d(0x1d2);});const _0x16c40c=document['getElementById'](_0x5daf14(0x1e3)),_0x9f3ccd=document[_0x5daf14(0x1c4)](_0x5daf14(0x1ce)),_0x34a16f=document['getElementById'](_0x5daf14(0x221)),_0x104163=document['getElementById']('userListPopup');_0x16c40c[_0x5daf14(0x1f3)]('click',()=>{const _0x59b1b4=_0x5daf14;if(!currentRoomRef)return;const _0x2238f7=document[_0x59b1b4(0x1c4)]('activeUsersList');_0x2238f7[_0x59b1b4(0x1c3)]='';const _0x46303e=ref(db,_0x59b1b4(0x1d1)+roomCode);onValue(_0x46303e,_0x351fd7=>{const _0x47e0c5=_0x59b1b4,_0x32cd07=_0x351fd7['val']()||{};_0x2238f7['innerHTML']='';for(const [_0xf75e3,_0x2e41bc]of Object[_0x47e0c5(0x1cd)](_0x32cd07)){const _0x2840de=document[_0x47e0c5(0x201)]('li');_0x2840de[_0x47e0c5(0x1d4)]=_0x2e41bc['name'],_0x2238f7[_0x47e0c5(0x1da)](_0x2840de);}},{'onlyOnce':!![]}),_0x104163[_0x59b1b4(0x20a)][_0x59b1b4(0x1ed)]=_0x59b1b4(0x21e),_0x34a16f[_0x59b1b4(0x20a)][_0x59b1b4(0x1ed)]=_0x59b1b4(0x21e);}),_0x9f3ccd[_0x5daf14(0x1f3)](_0x5daf14(0x205),()=>{const _0x136ab8=_0x5daf14;_0x104163[_0x136ab8(0x20a)][_0x136ab8(0x1ed)]=_0x136ab8(0x1f6),_0x34a16f[_0x136ab8(0x20a)][_0x136ab8(0x1ed)]=_0x136ab8(0x1f6);}),_0x34a16f[_0x5daf14(0x1f3)]('click',()=>{const _0x5458be=_0x5daf14;_0x104163[_0x5458be(0x20a)]['display']=_0x5458be(0x1f6),_0x34a16f[_0x5458be(0x20a)][_0x5458be(0x1ed)]=_0x5458be(0x1f6);});}),window[_0x1ca384(0x1df)]=()=>{const _0x29529b=_0x1ca384,_0x522d77=document[_0x29529b(0x1c4)](_0x29529b(0x21b)),_0x18d094=document[_0x29529b(0x1c4)](_0x29529b(0x1f0)),_0x57e494=document[_0x29529b(0x1c4)](_0x29529b(0x1dd)),_0x5997f1=document[_0x29529b(0x1c4)](_0x29529b(0x1ef));username=_0x522d77[_0x29529b(0x1de)][_0x29529b(0x20b)](),userEmail=_0x18d094['value']['trim'](),roomCode=_0x57e494['value']['trim']()[_0x29529b(0x1c8)]();if(!username||username[_0x29529b(0x21a)]<0x3){_0x5997f1[_0x29529b(0x1d4)]='Username\x20must\x20be\x20at\x20least\x203\x20characters';return;}if(!userEmail||!userEmail[_0x29529b(0x21c)]('@')){_0x5997f1[_0x29529b(0x1d4)]='Please\x20enter\x20a\x20valid\x20email';return;}if(!roomCode||roomCode[_0x29529b(0x21a)]<0x4){_0x5997f1[_0x29529b(0x1d4)]=_0x29529b(0x1f9);return;}_0x5997f1[_0x29529b(0x1d4)]='',currentUserId=Date['now']()[_0x29529b(0x204)](),document[_0x29529b(0x1c4)]('joinForm')[_0x29529b(0x20a)][_0x29529b(0x1ed)]=_0x29529b(0x1f6),document[_0x29529b(0x1c4)](_0x29529b(0x1e8))[_0x29529b(0x20a)][_0x29529b(0x1ed)]=_0x29529b(0x21e),document['getElementById']('roomCodeDisplay')['textContent']='*****',showRoomCode=![],currentRoomRef=ref(db,_0x29529b(0x1f7)+roomCode),set(ref(db,_0x29529b(0x1d1)+roomCode+'/'+currentUserId),{'name':username,'email':userEmail}),setupChatListeners(),checkIfKicked(),document[_0x29529b(0x1c4)](_0x29529b(0x214))['addEventListener'](_0x29529b(0x1e2),handleImageUpload),setupTypingIndicator();const _0x4f4366=document[_0x29529b(0x1c4)]('messageInput');_0x4f4366['addEventListener'](_0x29529b(0x207),handleTypingStart),_0x4f4366[_0x29529b(0x1f3)](_0x29529b(0x1cb),handleTypingEnd),_0x4f4366[_0x29529b(0x1f3)]('keypress',_0x5c40d4=>{const _0x4407ef=_0x29529b;_0x5c40d4['key']===_0x4407ef(0x1dc)&&sendMessage();}),window[_0x29529b(0x1f3)](_0x29529b(0x212),()=>{const _0x3f14d5=_0x29529b;remove(ref(db,_0x3f14d5(0x1d1)+roomCode+'/'+currentUserId)),stopTyping();});};function setupTypingIndicator(){const _0xd22930=_0x1ca384,_0xd6ff07=ref(db,_0xd22930(0x1d7)+roomCode);onValue(_0xd6ff07,_0x322de8=>{const _0x15dc4a=_0xd22930,_0x2cce03=_0x322de8['val']()||{},_0x34804a=Object[_0x15dc4a(0x1c9)](_0x2cce03)[_0x15dc4a(0x208)](_0x2c7152=>_0x2c7152['userId']!==currentUserId&&_0x2c7152[_0x15dc4a(0x1c5)])[_0x15dc4a(0x1d5)](_0x47e451=>_0x47e451['name']),_0x8da22b=document[_0x15dc4a(0x1c4)]('typingIndicator');_0x34804a[_0x15dc4a(0x21a)]>0x0?_0x8da22b[_0x15dc4a(0x1c3)]=_0x15dc4a(0x218)+_0x34804a[_0x15dc4a(0x209)](',\x20')+'\x20'+(_0x34804a[_0x15dc4a(0x21a)]>0x1?_0x15dc4a(0x1e1):'is')+_0x15dc4a(0x1fa):_0x8da22b[_0x15dc4a(0x1c3)]='';});}function handleTypingStart(){!isTyping&&(isTyping=!![],updateTypingStatus(!![])),clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{isTyping=![],updateTypingStatus(![]);},0x7d0);}function handleTypingEnd(){clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{isTyping=![],updateTypingStatus(![]);},0x7d0);}function _0x4361(_0x4bb8d9,_0x5f0a15){const _0x435389=_0x4353();return _0x4361=function(_0x436163,_0x18d9d4){_0x436163=_0x436163-0x1c3;let _0xab6ba9=_0x435389[_0x436163];return _0xab6ba9;},_0x4361(_0x4bb8d9,_0x5f0a15);}function updateTypingStatus(_0x13adee){const _0x570635=_0x1ca384;if(!currentUserId||!roomCode)return;set(ref(db,_0x570635(0x1d7)+roomCode+'/'+currentUserId),{'name':username,'isTyping':_0x13adee,'userId':currentUserId});}function _0x4353(){const _0x4fcc93=['eyeToggle','messageInput','</strong>:\x20','935594xraGeI','chatRoom','name','typingStatus','IMAGE\x20TOO\x20LARGE\x20(MAX\x203MB)','activeUsers','display','16516pzDxkz','joinError','userEmail','messages','1415jAwqST','addEventListener','</strong>\x20sent\x20an\x20image:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><img\x20src=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','none','rooms/','key','Room\x20code\x20must\x20be\x20at\x20least\x204\x20characters','\x20typing\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22typing-dots\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','886161237670','1427156ophNEL','833672TOOfAs','kickedUsers','1:886161237670:web:105822aeb49c11340d7667','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>','createElement','logout','DOMContentLoaded','toString','click','770399nkVQDj','keydown','filter','join','style','trim','shiftKey','chat_images/','imagefeed-45d0e.firebasestorage.app','val','now','target','beforeunload','files','imageUpload','kickedUsers/','UPLOAD\x20FAILED','AIzaSyDhYta0w2K_DQwa0SlBDA3FnfRNqog-ejE','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','div','length','username','includes','contextmenu','block','roomCodeDisplay','10254TDdwYq','popupOverlay','innerHTML','getElementById','isTyping','size','msg\x20img-msg','toUpperCase','values','https://imagefeed-45d0e-default-rtdb.firebaseio.com','keyup','imagefeed-45d0e.firebaseapp.com','entries','popupClose','UPLOAD\x20ERROR:','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22msg-time\x22>','activeUsers/','*****','18cTFIDY','textContent','map','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22msg-time\x22>','typingStatus/','2707668wmbNvu','2-digit','appendChild','ctrlKey','Enter','roomCode','value','joinChat','preventDefault','are','change','infoBtn'];_0x4353=function(){return _0x4fcc93;};return _0x4353();}function stopTyping(){if(!currentUserId||!roomCode)return;updateTypingStatus(![]);}function setupChatListeners(){onChildAdded(currentRoomRef,_0x1a320d=>{const _0x477af4=_0x4361,{name:_0x5d8023,message:_0x39c0ab,imageUrl:_0x3874b8,userId:_0x58bafe,timestamp:_0x35eb6c}=_0x1a320d[_0x477af4(0x20f)](),_0x5ea1e1=document[_0x477af4(0x201)](_0x477af4(0x219));_0x5ea1e1['className']=_0x3874b8?_0x477af4(0x1c7):'msg',_0x5ea1e1['id']=_0x1a320d['key'];const _0x45092e=new Date(_0x35eb6c),_0x31d848=_0x45092e['toLocaleTimeString']([],{'hour':_0x477af4(0x1d9),'minute':_0x477af4(0x1d9)});_0x3874b8?_0x5ea1e1[_0x477af4(0x1c3)]=_0x477af4(0x200)+_0x5d8023+_0x477af4(0x1f4)+_0x3874b8+_0x477af4(0x1d0)+_0x31d848+_0x477af4(0x1f5):_0x5ea1e1[_0x477af4(0x1c3)]=_0x477af4(0x200)+_0x5d8023+_0x477af4(0x1e6)+_0x39c0ab+_0x477af4(0x1d6)+_0x31d848+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x3d41b7=document['getElementById'](_0x477af4(0x1f1));_0x3d41b7[_0x477af4(0x1da)](_0x5ea1e1),_0x3d41b7['scrollTop']=_0x3d41b7['scrollHeight'];}),onChildRemoved(currentRoomRef,_0x315b54=>{const _0x4f795a=_0x4361,_0x4f29d4=document[_0x4f795a(0x1c4)](_0x315b54[_0x4f795a(0x1f8)]);_0x4f29d4&&_0x4f29d4['remove']();});}function checkIfKicked(){const _0x1d69e1=_0x1ca384;if(!currentUserId||!roomCode)return;userKickListener=onValue(ref(db,_0x1d69e1(0x215)+roomCode+'/'+currentUserId),_0x2b190e=>{const _0x16e225=_0x1d69e1;_0x2b190e['exists']()&&(handleKick(),remove(ref(db,_0x16e225(0x215)+roomCode+'/'+currentUserId)));});}function handleKick(){const _0x187a00=_0x1ca384;logout(),document[_0x187a00(0x1c4)](_0x187a00(0x1e8))[_0x187a00(0x20a)][_0x187a00(0x1ed)]=_0x187a00(0x1f6),document['getElementById']('joinForm')[_0x187a00(0x20a)]['display']=_0x187a00(0x1f6),document['getElementById']('kickedMessage')[_0x187a00(0x20a)][_0x187a00(0x1ed)]=_0x187a00(0x21e),setTimeout(()=>{const _0x1d1141=_0x187a00;document['getElementById']('kickedMessage')[_0x1d1141(0x20a)][_0x1d1141(0x1ed)]=_0x1d1141(0x1f6),document[_0x1d1141(0x1c4)]('joinForm')[_0x1d1141(0x20a)][_0x1d1141(0x1ed)]=_0x1d1141(0x21e);},0x1b58);}window['sendMessage']=()=>{const _0x38e648=_0x1ca384,_0x6743bf=document[_0x38e648(0x1c4)]('messageInput')[_0x38e648(0x1de)][_0x38e648(0x20b)]();_0x6743bf!==''&&currentRoomRef&&(push(currentRoomRef,{'name':username,'message':_0x6743bf,'timestamp':Date[_0x38e648(0x210)](),'userId':currentUserId}),document[_0x38e648(0x1c4)](_0x38e648(0x1e5))['value']='',stopTyping());};async function handleImageUpload(_0x2b41cf){const _0x5f4bf1=_0x1ca384,_0x803f6b=_0x2b41cf[_0x5f4bf1(0x211)][_0x5f4bf1(0x213)][0x0];if(!_0x803f6b)return;if(_0x803f6b[_0x5f4bf1(0x1c6)]>0x3*0x400*0x400){alert(_0x5f4bf1(0x1eb));return;}try{const _0x3bd266=_0x3687f9(storage,_0x5f4bf1(0x20d)+roomCode+'/'+Date['now']()+'_'+_0x803f6b[_0x5f4bf1(0x1e9)]);await uploadBytes(_0x3bd266,_0x803f6b);const _0x443e49=await getDownloadURL(_0x3bd266);push(currentRoomRef,{'name':username,'imageUrl':_0x443e49,'timestamp':Date[_0x5f4bf1(0x210)](),'userId':currentUserId}),_0x2b41cf[_0x5f4bf1(0x211)]['value']='';}catch(_0xda37c7){console['error'](_0x5f4bf1(0x1cf),_0xda37c7),alert(_0x5f4bf1(0x216));}}window[_0x1ca384(0x202)]=()=>{const _0x254f52=_0x1ca384;currentUserId&&roomCode&&(remove(ref(db,_0x254f52(0x1d1)+roomCode+'/'+currentUserId)),remove(ref(db,_0x254f52(0x1d7)+roomCode+'/'+currentUserId))),resetUserState(),document['getElementById']('joinForm')[_0x254f52(0x20a)][_0x254f52(0x1ed)]=_0x254f52(0x21e),document[_0x254f52(0x1c4)](_0x254f52(0x1e8))['style'][_0x254f52(0x1ed)]=_0x254f52(0x1f6);};function resetUserState(){const _0x5873ca=_0x1ca384;username='',userEmail='',roomCode='',currentUserId=null,currentRoomRef=null,document['getElementById'](_0x5873ca(0x1f1))[_0x5873ca(0x1c3)]='',document[_0x5873ca(0x1c4)](_0x5873ca(0x1ef))[_0x5873ca(0x1d4)]='',userKickListener&&(off(ref(db,_0x5873ca(0x215)+roomCode+'/'+currentUserId),userKickListener),userKickListener=null),clearTimeout(typingTimeout),isTyping=![];}document[_0x1ca384(0x1f3)](_0x1ca384(0x21d),_0x2f3546=>_0x2f3546[_0x1ca384(0x1e0)]()),document['addEventListener'](_0x1ca384(0x207),_0xe46643=>{const _0x5bbaa3=_0x1ca384;(_0xe46643[_0x5bbaa3(0x1f8)]==='F12'||_0xe46643[_0x5bbaa3(0x1db)]&&_0xe46643[_0x5bbaa3(0x20c)]&&(_0xe46643[_0x5bbaa3(0x1f8)]==='I'||_0xe46643[_0x5bbaa3(0x1f8)]==='J')||_0xe46643[_0x5bbaa3(0x1db)]&&_0xe46643[_0x5bbaa3(0x1f8)]==='U')&&_0xe46643[_0x5bbaa3(0x1e0)]();});
